hzm阅读素材
首页 使用教程 问题排查 更新日志
首页 使用教程 问题排查 更新日志
目录
	•	依赖安装失败
	•	端口占用无法启动
	•	访问不了网站
	•	数据库连接失败
	•	导出功能异常
	•	资料无法自动更新
	•	其他常见问题
	•	反馈渠道
部署问题排查指南
1 依赖安装失败
问题现象
执行 npm install 时报错，提示“依赖安装失败”“超时”“包不存在”等。
可能原因
	•	Node.js 版本不兼容（需 18+）
	•	网络问题导致 npm 源无法访问
	•	缓存冲突
解决方案
	1	检查 Node.js 版本： node -v  # 需显示 v18.0.0 及以上  若版本过低，前往 Node.js 官网 下载安装 18+ 版本。
	2	切换 npm 镜像源（解决网络问题）： npm config set registry https://registry.npmmirror.com 
	3	清除 npm 缓存后重新安装： npm cache clean --force
	4	rm -rf node_modules package-lock.json  # Windows 用：rd /s/q node_modules package-lock.json
	5	npm install 
2 端口占用无法启动
问题现象
执行 npm run start 或 docker-compose up -d 后，提示“Port 3000 is already in use”（端口 3000 被占用）。
解决方案
	1	更换端口（推荐）：
	◦	本地部署：在根目录 .env 文件中添加 PORT=8080（可替换为 8081、3001 等未占用端口），重新启动。
	◦	Docker 部署：修改 docker-compose.yml 中 ports 配置，例如 8080:3000（左侧为本地端口，右侧为容器端口）。
	2	关闭占用端口的进程： Windows（PowerShell）： netstat -ano | findstr "3000"  # 找到占用进程的 PID（最后一列数字）
	3	taskkill /F /PID 进程PID   Mac/Linux： lsof -i :3000  # 找到占用进程的 PID
	4	kill -9 进程PID   
3 访问不了网站
问题现象
部署后访问 http://localhost:3000 或服务器 IP+端口，提示“无法访问此网站”“超时”“404”。
可能原因
	•	服务未启动成功
	•	防火墙/安全组未开放端口
	•	服务器 IP 或端口配置错误
解决方案
	1	检查服务状态：
	◦	本地部署：执行 npm run start 后，查看终端是否显示“Server started on port 3000”（无报错）。
	◦	Docker 部署：执行 docker ps，查看容器是否处于“Up”状态（若为“Exited”，执行 docker logs 容器名 查看报错日志）。
	2	开放端口：
	◦	本地：关闭电脑防火墙（临时测试），或在防火墙设置中允许端口 3000 访问。
	◦	服务器（阿里云/腾讯云等）：在安全组规则中添加“入方向”，允许端口 3000（或自定义端口）的 TCP 访问。
	3	确认访问地址：
	◦	本地部署：仅能通过 http://localhost:3000 访问（同一局域网内可通过电脑 IP+端口访问）。
	◦	服务器部署：需通过服务器公网 IP+端口访问（例如 http://123.45.67.89:3000）。
4 数据库连接失败
问题现象
启动服务后，提示“Failed to connect to database”“数据库连接超时”。
可能原因
	•	数据库类型配置错误
	•	数据库地址/账号密码错误
	•	数据库未启动（Docker 部署）
解决方案
	1	检查环境变量配置（.env 文件）：
	◦	使用 SQLite（默认）：确保 DATABASE_TYPE=sqlite，无需额外配置 DATABASE_URL。
	◦	使用 MySQL：确保 DATABASE_URL=mysql://用户名:密码@数据库地址:3306/数据库名，且 MySQL 服务已启动、账号密码正确。
	2	Docker 部署 MySQL 时：
	◦	执行 docker ps 检查 db 容器是否启动，若未启动，执行 docker start db。
	◦	检查 docker-compose.yml 中 DATABASE_URL 是否与 MySQL 容器配置一致（例如用户名、密码、数据库名）。
5 导出功能异常
问题现象
点击“导出”按钮后，无响应、导出文件损坏、格式错误。
可能原因
	•	服务未完全启动
	•	导出目录无读写权限
	•	资料文件缺失或格式错误
解决方案
	1	等待服务完全启动：本地部署需等待终端显示“Server started”后，再尝试导出。
	2	赋予目录读写权限（Linux/Mac）： chmod -R 755 ./data  # 赋予数据目录读写权限 
	3	重新克隆仓库（资料文件缺失）： git clone https://github.com/1690291242-bot/169.git  # 重新克隆完整仓库 
6 资料无法自动更新
问题现象
后台未按设定的 Cron 表达式更新资料，时政热点、真题未同步。
可能原因
	•	自动更新功能未启用
	•	Cron 表达式格式错误
	•	网络问题导致无法获取更新资源
解决方案
	1	检查环境变量：确保 .env 文件中 UPDATE_CRON 格式正确（例如 0 3 * * * 表示每日凌晨 3 点）。
	2	手动触发更新（测试）：
	◦	本地部署：执行 npm run update 手动触发资料更新。
	◦	Docker 部署：执行 docker exec -it 169 npm run update（169 为容器名称，可通过 docker ps 查看）。
	3	检查网络：确保部署环境能正常访问外网（需获取时政、真题等网络资源）。
7 其他常见问题
问题 1：启动后提示“模块缺失”
解决方案：执行 npm install 重新安装依赖，若仍报错，删除 node_modules 和 package-lock.json 后重新安装（参考“依赖安装失败”解决方案）。
问题 2：Docker 部署后，容器很快退出
解决方案：执行 docker logs 容器ID 查看报错日志，根据日志提示排查（常见原因：数据库连接失败、端口占用、环境变量配置错误）。
问题 3：夜间模式/高亮样式不生效
解决方案：清除浏览器缓存后刷新页面，或在“个人中心”重新设置后保存。
8 反馈渠道
若以上方案无法解决问题，可通过以下方式反馈：
	•	GitHub Issues：提交问题（请详细描述问题现象、部署环境、报错日志）
	•	备考交流群：QQ群 XXXXXXXX（可替换为二维码链接）
hzm阅读素材
© 2025 hzm阅读素材. 基于 MIT 协议开源.

